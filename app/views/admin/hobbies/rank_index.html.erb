<div class="container text-center">
  <%= flash[:notice] %>
  <h2>ナイス趣味(月間)ランキング</h2>
　<% @rank_hobbies.each.with_index(1) do |hobby, i| %>
  　<% if hobby.is_draft == false %>
    第<%= i %>位
     <div class="row py-1 my-1 wrap mx-5 border-color">
        <div class="col-4 media">
          <%= link_to admin_user_path(hobby.user_id) do %>
          <%= image_tag hobby.user.get_profile_image(80,80)%>
          <% end %>
          <div class="media-body text-left pl-2">
            <h4><%= link_to hobby.user.name, admin_user_path(hobby.user_id) %></h4>
          </div>
        </div>
        <div class="col-8 text-left">
          <div class="row">
            <h5 class="col-5"><%= link_to "#{hobby.title}", admin_hobby_path(hobby.id) %></h5>
            <div class="col-5 d-flex">
              <div id="star-rate<%= hobby.id %>"></div>
              (<%= hobby.hobby_comments.average(:star).to_f.round(1) %>)
            </div>
            <script>
            $(document).on('turbolinks:load', function() {
              let elem = document.querySelector('#star-rate<%= hobby.id %>');
              if (elem == null) return;
              elem.innerHTML = "";
              let opt = {
                starOn: "<%= asset_path('star-on.png') %>",
                starOff: "<%= asset_path('star-off.png') %>",
                starHalf: "<%= asset_path('star-half.png') %>",
                score: "<%= hobby.hobby_comments.average(:star).to_f.round(1) %>",
                readOnly: true,
                half: true
              };
              raty(elem, opt);
            });
            </script>
            <div class="col-2 text-right">
              <%= link_to admin_tag_path(hobby.tag.id), class: "btn btn-outline-info rounded-pill" do %>
              <i class="fas fa-tag"></i>
              <%= hobby.tag.tag_name %>
              <% end %>
            </div>
          </div>
          <div class="row" style="width: 100%;">
            <!--ユーザーのつけた段落を反映-->
            <%= safe_join(hobby.body.split("\n"),tag(:br)) %>
          </div>
          <div class="row">
            <% hobby.hobby_images.each do |hobby_image| %>
            <%= image_tag(hobby_image, width:100, height:100 )%>
            <% end %>
          </div>
          <div class="row">
            <div class="col-3" id="favorite_buttons_<%= hobby.id %>">
              <%= hobby.favorites.count %> ナイス趣味
            </div>
            <div class=col-3>
            <%= link_to hobby_path(hobby.id) do %>
            <%= hobby.hobby_comments.count %> コメント
            <% end %>
            </div>
            <div class= "col-6 text-right" style="opacity: 0.5;">
              <%= hobby.how_long_ago %>
            </div>
          </div>
        </div>
      </div>
    <% end %>
  <% end %>
</div>